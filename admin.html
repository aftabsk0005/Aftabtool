<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Login - Aftab</title>
  <style>
    body {
      background: #000;
      color: #00ffe1;
      font-family: 'Arial', sans-serif;
      text-align: center;
      padding: 40px;
    }
    input, button {
      margin: 10px;
      padding: 10px;
      width: 80%;
      max-width: 300px;
      border-radius: 5px;
      border: 1px solid #00ffe1;
      background: #111;
      color: #00ffe1;
    }
    button {
      background-color: #00ffe1;
      color: #000;
      font-weight: bold;
      cursor: pointer;
    }
    #adminPanel {
      display: none;
      margin-top: 30px;
    }
    textarea, select {
      width: 100%;
    }
  </style>
</head>
<body>
  <h2>üîê Admin Login</h2>
  <div id="loginBox">
    <input type="text" id="username" placeholder="Username" />
    <input type="password" id="password" placeholder="Password" />
    <button onclick="checkLogin()">Login</button>
    <div id="loginError" style="color:red;"></div>
  </div>

  <div id="adminPanel">
    <h2>üõ†Ô∏è AFTAB Admin Panel</h2>
    <input type="text" id="toolName" placeholder="Tool Name" />
    <select id="toolType">
      <option value="mod">Mod APK</option>
      <option value="tool">Tool</option>
      <option value="premium">Premium</option>
    </select>
    <input type="text" id="toolLink" placeholder="Download Link" />
    <textarea id="toolDesc" placeholder="Description"></textarea>
    <input type="date" id="toolDate" />
    <input type="number" step="0.1" id="toolRating" placeholder="Rating (e.g., 4.5)" />
    <button onclick="submitTool()">‚ûï Add Tool</button>
    <div id="status" style="margin-top:15px; color:lime;"></div>
  </div>

  <script>
    const GITHUB_USERNAME = "aftabsk0005";
    const REPO_NAME = "Aftabtool";
    const FILE_PATH = "tools.json";

    let token = "";

    function checkLogin() {
      const user = document.getElementById("username").value;
      const pass = document.getElementById("password").value;

      if (user === "aftab" && pass === "h4ck3r") {
        token = prompt("Enter your GitHub token securely:");
        document.getElementById("loginBox").style.display = "none";
        document.getElementById("adminPanel").style.display = "block";
      } else {
        document.getElementById("loginError").innerText = "‚ùå Incorrect login";
      }
    }

    async function submitTool() {
      const name = document.getElementById("toolName").value;
      const type = document.getElementById("toolType").value;
      const link = document.getElementById("toolLink").value;
      const desc = document.getElementById("toolDesc").value;
      const date = document.getElementById("toolDate").value;
      const rating = document.getElementById("toolRating").value;

      if (!name || !type || !link || !desc || !date || !rating) {
        alert("Please fill in all fields!");
        return;
      }

      const newTool = { name, type, link, desc, date, rating, downloads: 0, likes: 0 };
      const url = `https://api.github.com/repos/${GITHUB_USERNAME}/${REPO_NAME}/contents/${FILE_PATH}`;
      const headers = {
        "Authorization": `token ${token}`,
        "Accept": "application/vnd.github.v3+json"
      };

      try {
        const res = await fetch(url, { headers });
        const data = await res.json();
        const tools = JSON.parse(atob(data.content.replace(/\\n/g, '')));
        tools.push(newTool);

        const update = await fetch(url, {
          method: "PUT",
          headers,
          body: JSON.stringify({
            message: `Added tool: ${name}`,
            content: btoa(JSON.stringify(tools, null, 2)),
            sha: data.sha
          })
        });

        if (update.ok) {
          document.getElementById("status").textContent = "‚úÖ Tool added successfully!";
        } else {
          document.getElementById("status").textContent = "‚ùå Failed to update tools.json";
        }
      } catch (err) {
        document.getElementById("status").textContent = "‚ùå Error: " + err.message;
      }
    }
  </script>
</body>
      </html>
